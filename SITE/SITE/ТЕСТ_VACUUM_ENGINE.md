# ⚡ Быстрый тест - Vacuum Engine + Bloomberg UI

## Запуск
```bash
cd SITE
npm run dev
```

Откройте: `http://localhost:5173`

---

## ✅ Проверка #1: Vacuum Engine (Консоль)

### Откройте DevTools (F12) → Console

**Ожидаемые логи:**
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[MOEX] 🌀 VACUUM ENGINE: Запуск полной загрузки TQBR за 2026-02-03
[MOEX] 🎯 Фильтр: board_group_id=57 (Основной рынок)
[MOEX] 📊 Режим: Пагинация с автоматической докачкой
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[MOEX] 📦 Батч 1: Загрузка записей 0-100...
[MOEX] ✅ Батч 1: Получено 100 записей
[MOEX] 📦 Батч 2: Загрузка записей 100-200...
[MOEX] ✅ Батч 2: Получено 100 записей
[MOEX] 📦 Батч 3: Загрузка записей 200-300...
[MOEX] ✅ Батч 3: Получено 67 записей
[MOEX] 🏁 Загрузка завершена (последний батч неполный)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[MOEX] 🎉 VACUUM ЗАВЕРШЕН: 267 акций TQBR
[MOEX] 📊 Батчей обработано: 3
[MOEX] ⚡ Средний размер батча: 89
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### Ключевые проверки:
- ✅ Видны **несколько батчей** (2-3)?
- ✅ Последний батч **< 100** записей?
- ✅ Итоговое число: **260-270** акций?
- ✅ Текст "**VACUUM ЗАВЕРШЕН**"?

---

## ✅ Проверка #2: Русские числа (Карточки сверху)

**Ожидаемое:**
```
┌──────────────┬──────────────┬──────────────┬──────────────┐
│ Всего акций  │ 🟢 Покупки   │ 🔴 Продажи   │ 💎 Дельта    │
│ 267          │ 125.3 млрд ₽ │ 98.2 млрд ₽  │ +27.1 млрд ₽ │
│ TQBR         │ Общий объем  │ Общий объем  │ Баланс       │
└──────────────┴──────────────┴──────────────┴──────────────┘
```

### Ключевые проверки:
- ✅ Числа в формате "**млрд ₽**" (не "B")?
- ✅ Дельта с префиксом "**+**" для положительных?
- ✅ Цвет дельты **зеленый** (если >0) или **красный** (если <0)?
- ✅ Эмодзи: **🟢 🔴 💎**?

---

## ✅ Проверка #3: Bloomberg Terminal UI (Таблица)

### Прокрутите таблицу вниз

**Ожидаемое:**
1. **Sticky Header:** Заголовок остается **сверху** при прокрутке
2. **Прогресс-бары:** Зеленая/Красная полоса с числами **внутри**
3. **Баланс:** Крупные жирные цифры **справа**

**Пример строки:**
```
┌──────┬────────┬────────────────────────────────────────┬──────────────┐
│ SBER │ 285.50 │[████████████████░░░░░░░░░░]           │ +220 млн ₽  │
│      │        │1.2 млрд ₽        980 млн ₽            │              │
└──────┴────────┴────────────────────────────────────────┴──────────────┘
```

### Ключевые проверки:

#### Header (при прокрутке):
- ✅ Остается **вверху экрана** (не прокручивается)?
- ✅ Темный фон с **размытием**?
- ✅ Колонки: **Тикер | Цена | Покупки/Продажи | Баланс (Δ)**?

#### Прогресс-бары:
- ✅ **Зеленый** слева (покупки)?
- ✅ **Красный** справа (продажи)?
- ✅ Числа **внутри** бара (белые с тенью)?
- ✅ Формат: "**1.2 млрд ₽**" (не "1.23B")?

#### Баланс (правая колонка):
- ✅ **Самые крупные** числа в таблице?
- ✅ **Жирный** шрифт (очень толстый)?
- ✅ Цвет: **Зеленый** (+) или **Красный** (-)?
- ✅ Формат: "**+220 млн ₽**" (без валюты в основном числе)?

#### Строки:
- ✅ Высокие (больше места между строками)?
- ✅ Чередующийся фон (светлее/темнее)?
- ✅ При наведении подсвечиваются?
- ✅ Клик открывает детальный вид?

---

## ✅ Проверка #4: Footer

**Ожидаемое внизу таблицы:**
```
┌─────────────────────────────────────────────────┐
│ Всего загружено: 267 акций TQBR                │
└─────────────────────────────────────────────────┘
```

### Ключевые проверки:
- ✅ Footer **под таблицей** (не внутри)?
- ✅ Число **совпадает** с карточкой "Всего акций"?
- ✅ Текст: "**Всего загружено: X акций TQBR**"?

---

## ✅ Проверка #5: Поиск

### Введите в строку поиска: "SBER"

**Ожидаемое:**
```
Всего загружено: 1 акций TQBR (найдено по запросу "SBER")
```

### Ключевые проверки:
- ✅ Отфильтрована **только** SBER?
- ✅ Footer показывает "**найдено по запросу...**"?
- ✅ Кнопка "**Очистить**" появилась?
- ✅ После очистки вернулись все 267 акций?

---

## 🐛 Если что-то не работает

### Проблема: Только 100 акций загружено

**Симптом:** В консоли:
```
[MOEX] 🎉 VACUUM ЗАВЕРШЕН: 100 акций TQBR
[MOEX] 📊 Батчей обработано: 1
```

**Диагностика:**
1. Проверьте, что виден **только 1 батч**
2. Возможно, API вернул пустой второй батч

**Решение:**
1. Жесткое обновление: `Ctrl+Shift+R`
2. Проверьте токен в `.env.local`
3. Попробуйте другую дату (может быть выходной)

---

### Проблема: Числа в формате "1.23B" вместо "1.2 млрд ₽"

**Симптом:** Карточки показывают английские суффиксы

**Решение:**
1. Жесткое обновление: `Ctrl+Shift+R`
2. Проверьте импорт в `StockScreener.tsx`:
   ```typescript
   import { formatCompactRu } from '@/lib/utils'
   ```
3. Проверьте использование:
   ```typescript
   {formatCompactRu(stock.val_b || 0)}
   ```

---

### Проблема: Header прокручивается вместе с таблицой

**Симптом:** Заголовок исчезает при прокрутке вниз

**Решение:**
Проверьте класс `thead`:
```typescript
<thead className="sticky top-0 z-10 ...">
```

Убедитесь, что:
- ✅ Есть `sticky`
- ✅ Есть `top-0`
- ✅ Есть `z-10`

---

### Проблема: Баланс не крупный

**Симптом:** Баланс того же размера, что и другие числа

**Решение:**
Проверьте класс в столбце баланса:
```typescript
<span className="text-2xl font-black font-mono ...">
```

Убедитесь, что:
- ✅ Есть `text-2xl` (крупный размер)
- ✅ Есть `font-black` (максимальная жирность)

---

### Проблема: Прогресс-бары бесцветные/серые

**Симптом:** Полосы не зеленые/красные, а серые

**Решение:**
Проверьте стили:
```typescript
className="bg-gradient-to-r from-[#10b981] to-[#059669] ..."
```

Убедитесь, что:
- ✅ Покупки: `from-[#10b981]` (зеленый)
- ✅ Продажи: `from-[#ef4444]` (красный)
- ✅ Есть `transition-all duration-300`

---

## ✅ Успешный тест = ВСЕ галочки ✓

- [x] Консоль: 2-3 батча, итого 260-270 акций
- [x] Карточки: Русские числа (млрд ₽)
- [x] Header: Sticky (остается сверху)
- [x] Прогресс-бары: Зеленый/Красный градиент
- [x] Числа в барах: Внутри, белые, читаемые
- [x] Баланс: Крупный, жирный, цветной
- [x] Footer: "Всего загружено: X акций TQBR"
- [x] Поиск: Фильтрация работает

---

## 🎉 Все работает?

**ОТЛИЧНО!** Vacuum Engine™ + Bloomberg Terminal UI полностью готовы!

**Есть проблемы?**  
Смотри полную документацию: `VACUUM_ENGINE_И_BLOOMBERG_UI.md`
