# ⚡ Быстрый тест - Futures Command Center

## Запуск
```bash
cd SITE
npm run dev
```

Откройте: `http://localhost:5173/futures-dashboard`

---

## ✅ Проверка #1: Консоль (F12)

**Ожидаемые логи:**
```
[useFutoiCandles] 🔍 Fetching candles for Si
[useFutoiCandles] 📅 Period: 1 days (2026-02-03 → 2026-02-03)
[MOEX] 📦 Processing 120 FUTOI records into candles...
[MOEX] ✅ Processed into 60 FUTOI candles
[useFutoiCandles] 📊 Processed 60 candles
```

### Ключевые проверки:
- ✅ Видны логи загрузки?
- ✅ Количество candles **> 0**?
- ✅ **Нет ошибок** API?

---

## ✅ Проверка #2: Top Bar

**Ожидаемое:**
```
┌──────────────────────────────────────────────────────┐
│ ⚡ Futures Command Center  [BULLISH]  [1 День] [14] │
└──────────────────────────────────────────────────────┘
```

### Ключевые проверки:
- ✅ Sentiment badge **BULLISH** или **BEARISH** виден?
- ✅ Цвет badge **зеленый** (BULLISH) или **красный** (BEARISH)?
- ✅ Кнопки "**1 День**" и "**14 Дней**" работают?
- ✅ Клик меняет подсветку кнопки?

---

## ✅ Проверка #3: Asset Selector

**Ожидаемое:**
```
┌─────────────────────────────────────────────────────┐
│ ВАЛЮТА                                              │
│ [💵 Si • USD/RUB] [💶 Eu • EUR/RUB] [💴 Cn • CNY]  │
│                                                     │
│ ИНДЕКСЫ                                             │
│ [📊 MX • MOEX] [📈 RI • RTS]                       │
│                                                     │
│ СЫРЬЕ                                               │
│ [🪙 GD • Золото] [🛢️ BR • Нефть]                  │
└─────────────────────────────────────────────────────┘
```

### Ключевые проверки:
- ✅ Все **3 категории** видны?
- ✅ **Эмодзи** перед тикерами?
- ✅ Клик на "**BR**" меняет актив?
- ✅ Активный актив выделен **фиолетовым**?
- ✅ Неактивные - серые?

---

## ✅ Проверка #4: Графики

### График 1: Price Action
```
┌─────────────────────────────────────┐
│ 📈 Цена                            │
│ [Cyan градиентная область]         │
└─────────────────────────────────────┘
```

**Проверки:**
- ✅ Цвет **Cyan** (голубой)?
- ✅ Градиент от светлого к прозрачному?
- ✅ Высота графика ~200px?

### График 2: NET Position Battle (ГЛАВНЫЙ)
```
┌─────────────────────────────────────────────────────┐
│ ⚡ Битва позиций (NET)   [🟣 Юр. Лица] [🟢 Физ.]   │
│ [Фиолетовая линия - умные деньги]                  │
│ [Зеленая линия - толпа]                             │
│ [Пунктирная линия на 0]                            │
└─────────────────────────────────────────────────────┘
```

**Проверки:**
- ✅ **Фиолетовая** линия (YUR NET) видна?
- ✅ **Зеленая** линия (FIZ NET) видна?
- ✅ Пунктирная линия на **уровне 0**?
- ✅ Высота графика **~300px** (самый высокий)?

**Кнопки-переключатели:**
- ✅ Клик на "🟣 **Юр. Лица**" скрывает фиолетовую линию?
- ✅ Кнопка становится **серой** при скрытии?
- ✅ Повторный клик **возвращает** линию?
- ✅ То же для "🟢 **Физ. Лица**"?

### График 3: Open Interest
```
┌─────────────────────────────────────┐
│ 📊 Открытый интерес (OI)           │
│ [Синие вертикальные бары]          │
└─────────────────────────────────────┘
```

**Проверки:**
- ✅ Цвет баров **синий** (#3b82f6)?
- ✅ Закругленные верхние углы?
- ✅ Высота графика ~200px?

---

## ✅ Проверка #5: Синхронизация

**Действие:** Наведите курсор на **любой график** в точке "10:30"

**Ожидаемое:**
- ✅ На **всех 3 графиках** появляется вертикальная линия на "10:30"?
- ✅ **Tooltips** показываются **одновременно** на всех графиках?

---

## ✅ Проверка #6: Stats Panel (Справа)

### Card 1: Sentiment
```
┌────────────────────┐
│ Настроение        ↗│
│ BULLISH            │ ← Зеленый цвет
│ На основе NET...   │
└────────────────────┘
```

**Проверки:**
- ✅ Текст "**BULLISH**" или "**BEARISH**"?
- ✅ Цвет **зеленый** (+) или **красный** (-)?
- ✅ Иконка **TrendingUp** (↗) или **TrendingDown** (↘)?

### Card 2: Умные деньги
```
┌────────────────────┐
│ 👔 Умные деньги    │
│ Лонги:    500 тыс  │ ← Зеленый
│ Шорты:    200 тыс  │ ← Красный
│ ──────────────────  │
│ NET:      +300 тыс │ ← Крупный, цветной
└────────────────────┘
```

**Проверки:**
- ✅ Лонги **зеленые**, шорты **красные**?
- ✅ NET **крупнее** остальных чисел?
- ✅ NET имеет **динамический цвет** (зеленый/красный)?
- ✅ Числа в формате "**300 тыс**" (не "300K")?

### Card 3: Толпа
```
┌────────────────────┐
│ 👥 Толпа (розница) │
│ Лонги:    100 тыс  │
│ Шорты:     50 тыс  │
│ ──────────────────  │
│ NET:       +50 тыс │
└────────────────────┘
```

**Проверки:**
- ✅ Аналогично Card 2?
- ✅ Зеленая рамка карточки?

### Card 4: Размер толпы
```
┌────────────────────┐
│ Размер толпы       │
│ 1,234              │ ← Cyan, крупно
│ Участников в рынке │
└────────────────────┘
```

**Проверки:**
- ✅ Число **крупное** и **Cyan**?
- ✅ Формат с разделителями: "**1,234**" (не "1234")?

---

## ✅ Проверка #7: Tooltips

**Действие:** Наведите на **График 2** в любой точке

**Ожидаемый tooltip:**
```
┌─────────────────────┐
│ 10:30              │
│ Юр. NET: +300 тыс  │ ← Фиолетовый
│ Физ. NET: +50 тыс  │ ← Зеленый
└─────────────────────┘
```

**Проверки:**
- ✅ Фон tooltip **темный** (#18181b)?
- ✅ Текст **белый**?
- ✅ Числа в русском формате ("**300 тыс**")?
- ✅ Без символа ₽?

---

## ✅ Проверка #8: Loading State

**Действие:** Перезагрузите страницу (`Ctrl+R`)

**Ожидаемое при загрузке:**
```
┌─────────────────────────────────────┐
│      [Spinner - анимация]          │
│   Загрузка данных FUTOI...         │
└─────────────────────────────────────┘
```

**Проверки:**
- ✅ Spinner **вращается**?
- ✅ Текст "**Загрузка данных FUTOI...**"?
- ✅ После загрузки появляются **графики**?

---

## ✅ Проверка #9: Empty State

**Действие:** Выберите актив, для которого **нет данных** (например, старый контракт)

**Ожидаемое:**
```
┌─────────────────────────────────────┐
│      [Иконка AlertCircle]          │
│         Нет данных                 │
│ Попробуйте выбрать другой актив... │
└─────────────────────────────────────┘
```

**Проверки:**
- ✅ Иконка **AlertCircle** видна?
- ✅ Текст "**Нет данных**"?
- ✅ Подсказка про другой актив/период?

---

## 🐛 Если что-то не работает

### Проблема: Нет данных (Empty State)

**Симптом:**
```
Нет данных
Попробуйте выбрать другой актив...
```

**Диагностика:**
1. Откройте консоль (F12)
2. Проверьте логи:
   ```
   [useFutoiCandles] 📊 Processed 0 candles
   [useFutoiCandles] ⚠️ No candles for Si!
   ```

**Возможные причины:**
- Выходной/праздничный день (нет торгов)
- Неправильный тикер (попробуйте другой: BR, RI)
- Увеличьте период: "14 Дней"

**Решение:**
1. Кликните "**14 Дней**"
2. Выберите другой актив (например, "**BR**")
3. Проверьте токен в `.env.local`

---

### Проблема: Графики не синхронизируются

**Симптом:** При наведении на график вертикальная линия только на одном графике

**Решение:**
Проверьте код в `FuturesDashboard.tsx`:
```typescript
<AreaChart data={chartData} syncId="futoi">
<LineChart data={chartData} syncId="futoi">
<BarChart data={chartData} syncId="futoi">
```

Убедитесь, что **везде** `syncId="futoi"`

---

### Проблема: Toggles не работают

**Симптом:** Клик на "🟣 Юр. Лица" не скрывает линию

**Решение:**
Проверьте state:
```typescript
const [visibleLines, setVisibleLines] = useState({
  yur: true,
  fiz: true,
})
```

И условие:
```typescript
{visibleLines.yur && <Line dataKey="yur_net" ... />}
```

---

### Проблема: Sentiment всегда BULLISH

**Симптом:** Badge всегда зеленый, даже когда YUR NET < 0

**Решение:**
Проверьте логику:
```typescript
const sentiment = latest && latest.yur_net > 0 ? 'BULLISH' : 'BEARISH'
```

Убедитесь, что `latest` содержит данные:
```javascript
console.log('Latest:', latest)
```

---

### Проблема: Числа в английском формате

**Симптом:** "300K" вместо "300 тыс"

**Решение:**
Убедитесь, что импортирован `formatCompactRu`:
```typescript
import { formatCompactRu } from '@/lib/utils'
```

И используется:
```typescript
{formatCompactRu(latest.yur_net, false)}
```

---

## ✅ Успешный тест = ВСЕ галочки ✓

- [x] Консоль: Логи загрузки видны, candles > 0
- [x] Top Bar: Sentiment badge с цветом
- [x] Asset Selector: 3 категории, клик работает
- [x] График 1: Cyan градиент
- [x] График 2: Фиолетовая + Зеленая линии
- [x] График 3: Синие бары
- [x] Toggles: Клик скрывает/показывает линии
- [x] Синхронизация: Все графики вместе
- [x] Stats Panel: 4 карточки с данными
- [x] Tooltips: Темные, белый текст, русские числа
- [x] Loading State: Spinner + текст
- [x] Empty State: Иконка + подсказка

---

## 🎉 Все работает?

**ОТЛИЧНО!** Futures Command Center полностью готов к трейдингу! 🚀

**Есть проблемы?**  
Смотри полную документацию: `FUTURES_COMMAND_CENTER.md`
