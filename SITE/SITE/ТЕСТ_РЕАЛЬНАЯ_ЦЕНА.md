# ⚡ Быстрый тест - Реальная цена фьючерсов

## Запуск
```bash
cd SITE
npm run dev
```

Откройте: `http://localhost:5173/futures-dashboard`

---

## ✅ Тест #1: Загрузка реальной цены

### Консоль (F12)

**Ожидаемое:**
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[MOEX] 📈 Fetching PRICE candles for Si
[MOEX] 📅 Range: 2026-02-03 → 2026-02-03
[MOEX] ⏱️ Interval: 60 min
[MOEX] 🎯 Normalized ticker: Si
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[MOEX] 🎯 Using nearest contract: SiH6 (expires: 2026-03-15)
[MOEX] ✅ Retrieved 10 price candles
[MOEX] 🔍 Sample candle: { begin: "2026-02-03T10:00:00", open: 95400, high: 95500, low: 95300, close: 95450, ... }
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[useFutoiCandles] 📦 FUTOI: 24 records
[useFutoiCandles] 📈 Price: 10 candles
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[useFutoiCandles] ✅ Merged 10/12 candles with price
[FuturesDashboard] 🔄 Processing chart data...
[FuturesDashboard] 📈 Price data: 10/12 candles
```

**Проверки:**
- ✅ Лог "Fetching PRICE candles" есть?
- ✅ Показывает nearest contract (SiH6)?
- ✅ Retrieved X candles (X > 0)?
- ✅ Merged data: большинство свечей с ценой?

---

## ✅ Тест #2: Яркая визуализация цены

### UI проверка

**Смотрим на график:**

**Левая Y-ось:**
```
95K ┤ ← СИНЯЯ ось (было серая)
94K ┤
93K ┤
    └─ Цена (₽) ← ЖИРНЫЙ СИНИЙ текст
```

**График:**
```
┌────────────────────────────────────┐
│ [Синяя яркая область ████▓▓░]     │ ← ВИДНА!
│ [Золотая линия ━━━]                │
│ [Зеленая линия ━━]                 │
└────────────────────────────────────┘
```

**Проверки:**
- ✅ Y-ось слева **синяя** (#3b82f6)?
- ✅ График цены **видимый** (не едва заметный)?
- ✅ Синий градиент от светлого к темному?
- ✅ Граница яркая синяя 2px?

---

## ✅ Тест #3: Tooltip с реальной ценой

### Действие
Наведите мышь на график в районе 10:00

### Ожидаемое

**Tooltip:**
```
┌─────────────────────────────┐
│ 10:00                       │
│ Цена: 95,450 ₽             │ ← Реальная!
│ Юр. NET: 400 тыс           │
│ Физ. Long: 1.5 млн         │
└─────────────────────────────┘
```

**Проверки:**
- ✅ Цена показывает **реальное значение** (не 95000 + random)?
- ✅ Значение разумное (в районе 95K для Si)?
- ✅ Форматирование с запятыми (95,450)?
- ✅ Есть символ ₽?

---

## ✅ Тест #4: Toggle цены работает

### Действие
1. Кликните на кнопку `👁️ Цена (фон)`

### Ожидаемое

**Кнопка изменилась:**
- Фон: серый → **темный**
- Иконка: `👁️ Eye` → `👁️off EyeOff`
- Текст: белый → **серый**

**График:**
```
Y-ось слева: ИСЧЕЗЛА
График цены: [НЕТ]
График позиций: [Занимает весь экран]
```

**Консоль:**
```
[CorrelationChart] 🎨 Rendering with domain: [...]
[CorrelationChart] 👁️ Visible: {
  yur: { long: false, short: false, net: true },
  fiz: { long: false, short: false, net: false }
}
```

**Проверка:**
- ✅ Синяя область цены **исчезла**?
- ✅ Y-ось слева **исчезла**?
- ✅ Кнопка стала **серой**?

---

## ✅ Тест #5: Разные фьючерсы

### Действие
1. Кликните в поле "🔍 Поиск фьючерсов..."
2. Введите "**BR**"
3. Выберите "BRH6" (нефть)

### Ожидаемое

**Консоль:**
```
[MOEX] 📈 Fetching PRICE candles for BR
[MOEX] 🎯 Using nearest contract: BRH6 (expires: 2026-03-15)
[MOEX] ✅ Retrieved X price candles
[useFutoiCandles] ✅ Merged X/Y candles with price
```

**График:**
```
Y-ось слева: Цена (₽) - ДРУГИЕ значения (для BR)
```

**Проверки:**
- ✅ Логи показывают "Fetching for BR"?
- ✅ График **обновился** с новыми данными?
- ✅ Цена на Y-оси **изменилась** (не Si, а BR)?

---

## 🐛 Если что-то не работает

### Проблема: Цена не загружается

**Симптом:**
```
[useFutoiCandles] 📈 Price: 0 candles
[useFutoiCandles] ✅ Merged 0/12 candles with price
```

**Диагностика:**
1. Проверьте консоль на ошибки API
2. Убедитесь, что фьючерс активен (Si, BR, RI, MX)
3. Проверьте дату - сегодня торговый день?

**Решение:**
- Попробуйте другой фьючерс (Si → BR)
- Увеличьте timeframe (1 день → 14 дней)

---

### Проблема: График цены не видимый

**Симптом:**
График цены есть, но едва видна (как раньше)

**Диагностика:**
Проверьте код в `FuturesDashboard.tsx`:
```typescript
<linearGradient id="colorPrice">
  <stop offset="5%" stopColor="#3b82f6" stopOpacity={0.4} />  ← Должно быть 0.4
  <stop offset="95%" stopColor="#1e3a8a" stopOpacity={0.1} />
</linearGradient>

<Area
  stroke="#3b82f6"      ← Должно быть #3b82f6 (синий)
  strokeWidth={2}       ← Должно быть 2
/>
```

**Решение:**
Жесткое обновление: `Ctrl+Shift+R`

---

### Проблема: Y-ось слева серая (не синяя)

**Решение:**
Проверьте код:
```typescript
<YAxis
  yAxisId="price"
  stroke="#3b82f6"  ← Должно быть синее
  label={{
    style: { fill: '#3b82f6', fontWeight: 'bold' }  ← Жирный синий
  }}
/>
```

---

## ✅ Успешный тест = ВСЕ галочки ✓

- [x] Консоль: Логи загрузки price candles
- [x] Консоль: Merged X/Y candles with price
- [x] График: Цена видна (синяя область)
- [x] Y-ось: Левая синяя, правая серая
- [x] Граница: Синяя 2px (яркая)
- [x] Tooltip: Показывает реальную цену
- [x] Toggle: Скрыть/показать цену работает
- [x] Omni-Search: Выбор фьючерса работает

---

## 🎉 Все работает?

**ОТЛИЧНО!** Теперь график показывает **реальную цену** фьючерса с **яркой визуализацией** и **двумя независимыми шкалами**! 🚀📈

**Читайте полную документацию:**  
`РЕАЛЬНАЯ_ЦЕНА_ФЬЮЧЕРСОВ.md` - Все детали, архитектура, примеры
