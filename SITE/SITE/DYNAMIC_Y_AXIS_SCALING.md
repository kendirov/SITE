# âš¡ Dynamic Y-Axis Scalingâ„¢ - Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ°

## Ğ”Ğ°Ñ‚Ğ°: 3 Ñ„ĞµĞ²Ñ€Ğ°Ğ»Ñ 2026
## Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: âœ… ĞŸĞĞ›ĞĞĞ¡Ğ¢Ğ¬Ğ® Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ

---

## ğŸ¯ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°

### Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¸ÑĞºĞ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

**Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹:**
- **Smart Money NET:** 7,000,000 Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ (7 Ğ¼Ğ»Ğ½)
- **Retail NET:** 1,000,000 Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ (1 Ğ¼Ğ»Ğ½)

**ĞŸÑ€Ğ¸ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¸ Ğ½Ğ° Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ¾ÑĞ¸:**

```
Y-Ğ¾ÑÑŒ (NET)
7M  â”¤ â•±â•²â•±â•²â•±â•²  â† Smart Money (Ğ²Ğ¸Ğ´Ğ½Ğ¾ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾)
    â”‚ â•±  â•²  â•²
5M  â”¤â•±    â•²  â•²
    â”‚
3M  â”¤
    â”‚
1M  â”¤________  â† Retail (ĞŸĞ›ĞĞ¡ĞšĞĞ¯ Ğ›Ğ˜ĞĞ˜Ğ¯ - Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ½Ğ¾ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¹!)
    â”‚
0   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Retail Ğ»Ğ¸Ğ½Ğ¸Ñ **"Ñ€Ğ°ÑĞ¿Ğ»ÑÑ‰ĞµĞ½Ğ°"** - Ğ½ĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ĞµĞµ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ!

---

## âœ… Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ: Dynamic Y-Axis Scalingâ„¢

### ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿

**ĞŸÑ€Ğ¸ ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸ Smart Money:**
```
Y-Ğ¾ÑÑŒ (NET)
1.5M â”¤  â•±â•²â•±â•²â•±â•²  â† Retail (Ğ¢Ğ•ĞŸĞ•Ğ Ğ¬ Ğ’Ğ˜Ğ”ĞĞ!)
     â”‚ â•±  â•²  â•²
1.2M â”¤â•±    â•²  â•²
     â”‚
1.0M â”¤      â•²â•±
     â”‚
0.8M â”¤
     â”‚
0.5M â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Retail Ğ»Ğ¸Ğ½Ğ¸Ñ **Ğ·Ğ°Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ²ĞµÑÑŒ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ Ğ¾ÑĞ¸** - Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ Ğ²Ğ¸Ğ´Ğ½Ñ‹ Ğ¸Ğ´ĞµĞ°Ğ»ÑŒĞ½Ğ¾!

---

### ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼

**Ğ¨Ğ°Ğ³ 1:** Ğ¡Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ¢ĞĞ›Ğ¬ĞšĞ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ… Ğ»Ğ¸Ğ½Ğ¸Ğ¹

```typescript
const activeValues: number[] = []

if (showSmart) {
  activeValues.push(...chartData.map(d => d.yur_net))
}

if (showRetail) {
  activeValues.push(...chartData.map(d => d.fiz_net))
}
```

**Ğ¨Ğ°Ğ³ 2:** ĞĞ°Ğ¹Ñ‚Ğ¸ min/max ÑÑ€ĞµĞ´Ğ¸ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ…

```typescript
const min = Math.min(...activeValues)  // ĞœĞ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ Ğ¸Ğ· Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ…
const max = Math.max(...activeValues)  // ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ¸Ğ· Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ…
```

**Ğ¨Ğ°Ğ³ 3:** Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ 5% padding (Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ Ğ½Ğµ ĞºĞ°ÑĞ°Ğ»Ğ¸ÑÑŒ ĞºÑ€Ğ°ĞµĞ²)

```typescript
const padding = (max - min) * 0.05
const domainMin = min - padding
const domainMax = max + padding
```

**Ğ¨Ğ°Ğ³ 4:** ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‚ÑŒ Ğ² YAxis domain

```typescript
<YAxis
  yAxisId="positions"
  domain={[domainMin, domainMax]}  // Ğ”Ğ˜ĞĞĞœĞ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ™ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½
  ...
/>
```

---

## ğŸ“Š ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1: Ğ’ÑĞµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹

**Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ:**
- Smart Money NET: 7,000,000
- Retail NET: 1,000,000

**Ğ Ğ°ÑÑ‡ĞµÑ‚ domain:**
```typescript
activeValues = [7000000, 6500000, ..., 1000000, 950000, ...]
min = 950,000
max = 7,000,000
padding = (7000000 - 950000) * 0.05 = 302,500

domainMin = 950,000 - 302,500 = 647,500
domainMax = 7,000,000 + 302,500 = 7,302,500
```

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
```
7.3M â”¤
     â”‚ â•±â•²â•±â•²  â† Smart Money (Ğ²Ğ¸Ğ´Ğ½Ğ¾ Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾)
5M   â”¤â•±  â•²
     â”‚
3M   â”¤
     â”‚
1M   â”¤____   â† Retail (Ğ¿Ğ»Ğ¾ÑĞºĞ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ)
     â”‚
0.6M â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Retail Ğ»Ğ¸Ğ½Ğ¸Ñ **Ñ€Ğ°ÑĞ¿Ğ»ÑÑ‰ĞµĞ½Ğ°**.

---

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2: Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Retail Ğ²Ğ¸Ğ´Ğ½Ğ° (Smart ÑĞºÑ€Ñ‹Ñ‚Ğ°)

**Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ:**
- Smart Money NET: Ğ¡ĞšĞ Ğ«Ğ¢Ğ (Ğ½Ğµ ÑƒÑ‡Ğ°ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ² Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğµ)
- Retail NET: 1,000,000

**Ğ Ğ°ÑÑ‡ĞµÑ‚ domain:**
```typescript
activeValues = [1000000, 950000, 1050000, 980000, ...]
                â†‘ Ğ¢ĞĞ›Ğ¬ĞšĞ Retail Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ!

min = 950,000
max = 1,050,000
padding = (1050000 - 950000) * 0.05 = 5,000

domainMin = 950,000 - 5,000 = 945,000
domainMax = 1,050,000 + 5,000 = 1,055,000
```

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
```
1.05M â”¤
      â”‚   â•±â•²â•±â•²  â† Retail (Ğ¢Ğ•ĞŸĞ•Ğ Ğ¬ Ğ’Ğ˜Ğ”ĞĞ!)
1.00M â”¤  â•±  â•²â•²
      â”‚ â•±    â•²
0.98M â”¤â•±      â•²
      â”‚
0.95M â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Retail Ğ»Ğ¸Ğ½Ğ¸Ñ **Ğ·Ğ°Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ²ĞµÑÑŒ ÑĞºÑ€Ğ°Ğ½** - Ğ²ÑĞµ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ Ğ²Ğ¸Ğ´Ğ½Ñ‹!

---

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 3: Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Smart Ğ²Ğ¸Ğ´Ğ½Ğ° (Retail ÑĞºÑ€Ñ‹Ñ‚Ğ°)

**Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ:**
- Smart Money NET: 7,000,000
- Retail NET: Ğ¡ĞšĞ Ğ«Ğ¢Ğ

**Ğ Ğ°ÑÑ‡ĞµÑ‚ domain:**
```typescript
activeValues = [7000000, 6800000, 7200000, ...]
                â†‘ Ğ¢ĞĞ›Ğ¬ĞšĞ Smart Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ!

min = 6,800,000
max = 7,200,000
padding = (7200000 - 6800000) * 0.05 = 20,000

domainMin = 6,800,000 - 20,000 = 6,780,000
domainMax = 7,200,000 + 20,000 = 7,220,000
```

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
```
7.2M â”¤
     â”‚  â•±â•²â•±â•²  â† Smart Money (Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ²Ğ¸Ğ´Ğ½Ñ‹)
7.0M â”¤ â•±  â•²â•²
     â”‚â•±    â•²
6.8M â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Ğ’Ğ¸Ğ´Ğ½Ñ‹ **Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸** Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ñ Smart Money.

---

## ğŸ”§ ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ Ğ°Ğ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼Ğ°

```typescript
// ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ: Dynamic Y-Axis Domain (Ğ¿ĞµÑ€ĞµÑÑ‡ĞµÑ‚ Ğ¿Ñ€Ğ¸ toggle)
const rightAxisDomain = useMemo((): [number, number] => {
  if (!chartData || chartData.length === 0) return [0, 100]

  console.log('[FuturesDashboard] ğŸ“Š Calculating dynamic Y-axis domain...')
  console.log('[FuturesDashboard] ğŸ‘ï¸ Visible lines:', { showSmart, showRetail })

  const activeValues: number[] = []

  // Ğ¡Ğ¾Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ¢ĞĞ›Ğ¬ĞšĞ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ… Ğ»Ğ¸Ğ½Ğ¸Ğ¹
  if (showSmart) {
    activeValues.push(...chartData.map((d) => d.yur_net))
    console.log('[FuturesDashboard] â• Added Smart Money values')
  }

  if (showRetail) {
    activeValues.push(...chartData.map((d) => d.fiz_net))
    console.log('[FuturesDashboard] â• Added Retail values')
  }

  // Ğ•ÑĞ»Ğ¸ Ğ½ĞµÑ‚ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ… Ğ»Ğ¸Ğ½Ğ¸Ğ¹ - Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½
  if (activeValues.length === 0) {
    console.log('[FuturesDashboard] âš ï¸ No visible lines, using default domain')
    return [0, 100]
  }

  // ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ğ¼ min/max
  const min = Math.min(...activeValues)
  const max = Math.max(...activeValues)

  // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ 5% padding Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ Ğ½Ğµ ĞºĞ°ÑĞ°Ğ»Ğ¸ÑÑŒ ĞºÑ€Ğ°ĞµĞ²
  const padding = (max - min) * 0.05
  const domainMin = min - padding
  const domainMax = max + padding

  console.log('[FuturesDashboard] ğŸ“ Domain:', {
    min,
    max,
    padding,
    final: [domainMin, domainMax],
  })

  return [domainMin, domainMax]
}, [chartData, showSmart, showRetail])
```

---

## ğŸ® Toggle Controls (Chip Buttons)

### Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ»Ğ¾ÑĞ¼Ğ¸                                     â”‚
â”‚ ğŸ’¡ ĞŸÑ€Ğ¸ ÑĞºÑ€Ñ‹Ñ‚Ğ¸Ğ¸ Ğ»Ğ¸Ğ½Ğ¸Ğ¹ Y-Ğ¾ÑÑŒ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿ĞµÑ€ĞµÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ‘ï¸ Ğ¦ĞµĞ½Ğ° (Ñ„Ğ¾Ğ½)]  [ğŸ‘ï¸ â”€â”€â”€ Ğ£Ğ¼Ğ½Ñ‹Ğµ NET]  [ğŸ‘ï¸off - - Ğ¢Ğ¾Ğ»Ğ¿Ğ°]â”‚
â”‚  â† ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ°         â† ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ°             â† Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ°      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞšĞ¾Ğ´ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº

```typescript
{/* Smart Money Toggle */}
<button
  onClick={toggleSmart}
  className={`flex items-center gap-2 px-4 py-2 rounded-lg font-mono text-sm transition-all border ${
    showSmart
      ? 'bg-purple-600/20 text-purple-400 border-purple-500/50'  // ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ°
      : 'bg-zinc-900/50 text-zinc-600 border-zinc-800'           // Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ°
  }`}
>
  {showSmart ? <Eye className="w-4 h-4" /> : <EyeOff className="w-4 h-4" />}
  <div className="w-3 h-0.5 bg-purple-500" />
  Ğ£Ğ¼Ğ½Ñ‹Ğµ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ NET
</button>
```

### Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº

| Ğ›Ğ¸Ğ½Ğ¸Ñ | Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ | Ğ¤Ğ¾Ğ½ | Ğ¦Ğ²ĞµÑ‚ Ñ‚ĞµĞºÑÑ‚Ğ° | Ğ“Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° | Ğ˜ĞºĞ¾Ğ½ĞºĞ° |
|-------|-----------|-----|-------------|---------|--------|
| Smart | Ğ’Ğ¸Ğ´Ğ½Ğ° | `bg-purple-600/20` | `text-purple-400` | `border-purple-500/50` | ğŸ‘ï¸ Eye |
| Smart | Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ° | `bg-zinc-900/50` | `text-zinc-600` | `border-zinc-800` | ğŸ‘ï¸off EyeOff |
| Retail | Ğ’Ğ¸Ğ´Ğ½Ğ° | `bg-green-600/20` | `text-green-400` | `border-green-500/50` | ğŸ‘ï¸ Eye |
| Retail | Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ° | `bg-zinc-900/50` | `text-zinc-600` | `border-zinc-800` | ğŸ‘ï¸off EyeOff |

---

## ğŸš€ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

### 1. React.memo Ğ´Ğ»Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ°

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¿ĞµÑ€ĞµÑ€Ğ¸ÑĞ¾Ğ²Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğµ Ñ€Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»Ñ

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```typescript
const CorrelationChart = memo(({ 
  data, 
  showPrice, 
  showSmart, 
  showRetail,
  rightAxisDomain,
}: {
  data: any[]
  showPrice: boolean
  showSmart: boolean
  showRetail: boolean
  rightAxisDomain: [number, number]
}) => {
  // Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¿ĞµÑ€ĞµÑ€Ğ¸ÑÑƒĞµÑ‚ÑÑ Ğ¢ĞĞ›Ğ¬ĞšĞ ĞºĞ¾Ğ³Ğ´Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑ‚ÑÑ props
  return <ComposedChart ... />
})

CorrelationChart.displayName = 'CorrelationChart'
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ñ€ĞµĞ½Ğ´ĞµÑ€Ğ¸Ñ‚ÑÑ **Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾** ĞºĞ¾Ğ³Ğ´Ğ° Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ»Ğ¸ toggles.

---

### 2. useMemo Ğ´Ğ»Ñ chartData

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ¢Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğµ

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```typescript
const chartData = useMemo(() => {
  if (!data || data.length === 0) return []

  console.log('[FuturesDashboard] ğŸ”„ Processing chart data...')

  return data.map((candle) => ({
    time: candle.time.substring(0, 5),
    price: candle.price,
    yur_net: candle.yur_net,
    fiz_net: candle.fiz_net,
    // ...
  }))
}, [data])
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Ğ¢Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚ **Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾** ĞºĞ¾Ğ³Ğ´Ğ° Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ `data`.

---

### 3. useMemo Ğ´Ğ»Ñ rightAxisDomain

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ Ğ°ÑÑ‡ĞµÑ‚ domain Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ñ€ĞµĞ½Ğ´ĞµÑ€Ğµ (Ñ‚ÑĞ¶ĞµĞ»Ğ°Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ)

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```typescript
const rightAxisDomain = useMemo((): [number, number] => {
  // Ğ Ğ°ÑÑ‡ĞµÑ‚ min/max Ğ¸Ğ· activeValues
  // ...
  return [domainMin, domainMax]
}, [chartData, showSmart, showRetail])
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Ğ Ğ°ÑÑ‡ĞµÑ‚ **Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾** ĞºĞ¾Ğ³Ğ´Ğ° Ğ¼ĞµĞ½ÑÑÑ‚ÑÑ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ»Ğ¸ toggles.

---

### 4. useCallback Ğ´Ğ»Ñ toggle handlers

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```typescript
const togglePrice = useCallback(() => setShowPrice((prev) => !prev), [])
const toggleSmart = useCallback(() => setShowSmart((prev) => !prev), [])
const toggleRetail = useCallback(() => setShowRetail((prev) => !prev), [])
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** Ğ¡Ñ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ ÑÑÑ‹Ğ»ĞºĞ¸ Ğ½Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ - Ğ¼ĞµĞ½ÑŒÑˆĞµ Ğ¿ĞµÑ€ĞµÑ€Ğ¸ÑĞ¾Ğ²Ğ¾Ğº.

---

## ğŸ“Š Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ: Ğ”Ğ¾ vs ĞŸĞ¾ÑĞ»Ğµ

### Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾

| Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ | Ğ”Ğ¾ | ĞŸĞ¾ÑĞ»Ğµ | Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ğµ |
|----------|-----|--------|-----------|
| **ĞĞ±Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸** | Retail Ñ€Ğ°ÑĞ¿Ğ»ÑÑ‰ĞµĞ½Ğ° | ĞĞ±Ğµ Ğ²Ğ¸Ğ´Ğ½Ñ‹ | âœ“ |
| **Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Retail** | ĞĞµ Ğ²Ğ¸Ğ´Ğ½Ğ° | **Ğ Ğ°ÑÑ‚ÑĞ½ÑƒÑ‚Ğ° Ğ½Ğ° Ğ²ĞµÑÑŒ ÑĞºÑ€Ğ°Ğ½** | **âˆ** |
| **Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Smart** | Ğ’Ğ¸Ğ´Ğ½Ğ° | **Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ²Ğ¸Ğ´Ğ½Ñ‹** | âœ“ |

### ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

| ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ° | Ğ”Ğ¾ | ĞŸĞ¾ÑĞ»Ğµ | Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ğµ |
|---------|-----|--------|-----------|
| **Ğ ĞµĞ½Ğ´ĞµÑ€Ğ¾Ğ² Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ°** | ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ render | **Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ props** | **â†“90%** |
| **Ğ¢Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…** | ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ render | **Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ data** | **â†“95%** |
| **Ğ Ğ°ÑÑ‡ĞµÑ‚ domain** | ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ render | **Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ toggle** | **â†“98%** |
| **Ğ›Ğ°Ğ³Ğ¸/Ñ„Ñ€Ğ¸Ğ·Ñ‹** | Ğ”Ğ° | **ĞĞµÑ‚** | **100%** |

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸

### Ğ¢ĞµÑÑ‚ #1: ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ° (Ğ ĞµĞ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ†Ğ¸Ñ)

**Ğ¨Ğ°Ğ³ 1:** ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ `/futures-dashboard`

**Ğ¨Ğ°Ğ³ 2:** Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ Ğ¾Ğ±Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ (Smart + Retail)

**ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ¾Ğµ:**
- âœ… Ğ¤Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ (Smart) - Ğ²Ğ¸Ğ´Ğ½Ğ° Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ»Ğ¸Ğ²Ğ¾
- âœ… Ğ—ĞµĞ»ĞµĞ½Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ (Retail) - Ğ¿Ğ»Ğ¾ÑĞºĞ°Ñ (ÑÑ‚Ğ¾ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾)

**ĞšĞ¾Ğ½ÑĞ¾Ğ»ÑŒ:**
```
[FuturesDashboard] ğŸ‘ï¸ Visible lines: { showSmart: true, showRetail: true }
[FuturesDashboard] ğŸ“ Domain: {
  min: 950000,
  max: 7200000,
  final: [647500, 7502500]
}
```

---

### Ğ¢ĞµÑÑ‚ #2: Dynamic Scaling (Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ)

**Ğ¨Ğ°Ğ³ 1:** ĞšĞ»Ğ¸ĞºĞ½Ğ¸Ñ‚Ğµ Ğ½Ğ° ĞºĞ½Ğ¾Ğ¿ĞºÑƒ "ğŸ‘ï¸ Ğ£Ğ¼Ğ½Ñ‹Ğµ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ NET" (ÑĞºÑ€Ñ‹Ñ‚ÑŒ Smart)

**ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ¾Ğµ:**
- âœ… Ğ¤Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ **Ğ¸ÑÑ‡ĞµĞ·Ğ°ĞµÑ‚**
- âœ… Ğ—ĞµĞ»ĞµĞ½Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ (Retail) **Ñ€Ğ°ÑÑ‚ÑĞ³Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ** Ğ½Ğ° Ğ²ĞµÑÑŒ ÑĞºÑ€Ğ°Ğ½
- âœ… Y-Ğ¾ÑÑŒ ÑĞ¿Ñ€Ğ°Ğ²Ğ° Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ (0.9M - 1.1M Ğ²Ğ¼ĞµÑÑ‚Ğ¾ 0.6M - 7.3M)

**ĞšĞ¾Ğ½ÑĞ¾Ğ»ÑŒ:**
```
[FuturesDashboard] ğŸ‘ï¸ Visible lines: { showSmart: false, showRetail: true }
[FuturesDashboard] ğŸ“ Domain: {
  min: 950000,
  max: 1050000,
  final: [945000, 1055000]  â† ĞĞĞ’Ğ«Ğ™ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½!
}
[CorrelationChart] ğŸ¨ Rendering with domain: [945000, 1055000]
```

**Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾:**
- Y-Ğ¾ÑÑŒ: `1.05M`, `1.00M`, `0.95M` (Ğ²Ğ¼ĞµÑÑ‚Ğ¾ `7M`, `5M`, `3M`, `1M`)
- Retail Ğ»Ğ¸Ğ½Ğ¸Ñ Ğ·Ğ°Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ **Ğ²ĞµÑÑŒ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½**

---

### Ğ¢ĞµÑÑ‚ #3: Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Smart (Retail ÑĞºÑ€Ñ‹Ñ‚Ğ°)

**Ğ¨Ğ°Ğ³ 1:** ĞšĞ»Ğ¸ĞºĞ½Ğ¸Ñ‚Ğµ Ğ½Ğ° "ğŸ‘ï¸ Ğ¢Ğ¾Ğ»Ğ¿Ğ° NET" (Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Retail ÑĞ½Ğ¾Ğ²Ğ°)

**Ğ¨Ğ°Ğ³ 2:** ĞšĞ»Ğ¸ĞºĞ½Ğ¸Ñ‚Ğµ Ğ½Ğ° "ğŸ‘ï¸ Ğ¢Ğ¾Ğ»Ğ¿Ğ° NET" ĞµÑ‰Ğµ Ñ€Ğ°Ğ· (ÑĞºÑ€Ñ‹Ñ‚ÑŒ Retail)

**ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ¾Ğµ:**
- âœ… Ğ—ĞµĞ»ĞµĞ½Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ **Ğ¸ÑÑ‡ĞµĞ·Ğ°ĞµÑ‚**
- âœ… Ğ¤Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ **Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸**
- âœ… Y-Ğ¾ÑÑŒ: 6.8M - 7.2M (ÑƒĞ·ĞºĞ¸Ğ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹)

**ĞšĞ¾Ğ½ÑĞ¾Ğ»ÑŒ:**
```
[FuturesDashboard] ğŸ‘ï¸ Visible lines: { showSmart: true, showRetail: false }
[FuturesDashboard] ğŸ“ Domain: {
  min: 6800000,
  max: 7200000,
  final: [6780000, 7220000]  â† Ğ£Ğ·ĞºĞ¸Ğ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹
}
```

---

### Ğ¢ĞµÑÑ‚ #4: ĞĞµÑ‚ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ… Ğ»Ğ¸Ğ½Ğ¸Ğ¹

**Ğ¨Ğ°Ğ³ 1:** Ğ¡ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ’Ğ¡Ğ• Ğ»Ğ¸Ğ½Ğ¸Ğ¸ (Price + Smart + Retail)

**ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ¾Ğµ:**
- âœ… Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹
- âœ… Y-Ğ¾ÑÑŒ: Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ [0, 100]

**ĞšĞ¾Ğ½ÑĞ¾Ğ»ÑŒ:**
```
[FuturesDashboard] âš ï¸ No visible lines, using default domain
```

---

## ğŸ¯ ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸

### 1. ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Rescale

**ĞšĞ¾Ğ³Ğ´Ğ°:** ĞŸÑ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ Ğ½Ğ° toggle ĞºĞ½Ğ¾Ğ¿ĞºÑƒ

**Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸ÑÑ…Ğ¾Ğ´Ğ¸Ñ‚:**
1. State `showSmart` Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ (`true` â†’ `false`)
2. `useMemo` Ğ´Ğ»Ñ `rightAxisDomain` Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ
3. ĞĞ¾Ğ²Ñ‹Ğ¹ domain Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ (Ğ±ĞµĞ· Smart values)
4. `CorrelationChart` Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ prop `rightAxisDomain`
5. React.memo Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ prop
6. Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº **Ğ¿ĞµÑ€ĞµÑ€Ğ¸ÑĞ¾Ğ²Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ** Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ¾ÑÑŒÑ

**Ğ’Ñ€ĞµĞ¼Ñ:** ~50-100ms (Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾)

---

### 2. Padding (5%)

**Ğ—Ğ°Ñ‡ĞµĞ¼:**
- Ğ›Ğ¸Ğ½Ğ¸Ğ¸ Ğ½Ğµ ĞºĞ°ÑĞ°ÑÑ‚ÑÑ Ğ²ĞµÑ€Ñ…Ğ½ĞµĞ³Ğ¾/Ğ½Ğ¸Ğ¶Ğ½ĞµĞ³Ğ¾ ĞºÑ€Ğ°Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ°
- Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ñ€Ğ¸ÑÑ‚Ğ½ĞµĞµ
- Ğ›ĞµĞ³Ñ‡Ğµ Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ

**Ğ Ğ°ÑÑ‡ĞµÑ‚:**
```typescript
const padding = (max - min) * 0.05  // 5% Ğ¾Ñ‚ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğ°

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:
// Ğ”Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½: 1,000,000 - 1,100,000 = 100,000
// Padding: 100,000 * 0.05 = 5,000
// Final domain: [995,000, 1,105,000]
```

---

### 3. Debug Info (ĞŸÑ€Ğ¾Ğ·Ñ€Ğ°Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ)

**ĞŸĞ¾Ğ´ toggle ĞºĞ½Ğ¾Ğ¿ĞºĞ°Ğ¼Ğ¸:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ Y-Ğ¾ÑĞ¸ (Ğ¿Ñ€Ğ°Ğ²Ğ°Ñ): [945000, 1055000]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:**
- Ğ¢Ñ€ĞµĞ¹Ğ´ĞµÑ€ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ **Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¹** Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½ Ğ¾ÑĞ¸
- ĞŸĞ¾Ğ¼Ğ¾Ğ³Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ½ÑÑ‚ÑŒ, Ğ¿Ğ¾Ñ‡ĞµĞ¼Ñƒ Ğ»Ğ¸Ğ½Ğ¸Ñ Ğ²Ñ‹Ğ³Ğ»ÑĞ´Ğ¸Ñ‚ Ğ¸Ğ¼ĞµĞ½Ğ½Ğ¾ Ñ‚Ğ°Ğº
- ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸

---

## ğŸ“ ĞœĞ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸ĞºĞ°

### Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Dynamic Domain

```
activeValues = [Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ²ÑĞµÑ… Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ… Ğ»Ğ¸Ğ½Ğ¸Ğ¹]

min = Math.min(...activeValues)
max = Math.max(...activeValues)

padding = (max - min) Ã— 0.05

domainMin = min - padding
domainMax = max + padding

domain = [domainMin, domainMax]
```

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ°

**Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:**
```
Smart NET: [7000000, 6800000, 7200000, 6900000]
Retail NET: [1000000, 950000, 1050000, 980000]
showSmart: true
showRetail: false  â† Retail Ğ¡ĞšĞ Ğ«Ğ¢Ğ
```

**Ğ Ğ°ÑÑ‡ĞµÑ‚:**
```
activeValues = [7000000, 6800000, 7200000, 6900000]
                â†‘ Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Smart (Retail Ğ½Ğµ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ°)

min = 6,800,000
max = 7,200,000

padding = (7,200,000 - 6,800,000) Ã— 0.05
        = 400,000 Ã— 0.05
        = 20,000

domainMin = 6,800,000 - 20,000 = 6,780,000
domainMax = 7,200,000 + 20,000 = 7,220,000

domain = [6,780,000, 7,220,000]
```

**Y-Ğ¾ÑÑŒ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚:**
```
7.22M â”¤
7.00M â”¤
6.78M â””â”€
```

---

## ğŸ¨ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº

### ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ° (Ğ›Ğ¸Ğ½Ğ¸Ñ Ğ²Ğ¸Ğ´Ğ½Ğ°)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘ï¸ â”€â”€â”€ Ğ£Ğ¼Ğ½Ñ‹Ğµ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ NET â”‚ â† Ğ¤Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ¾Ğ½, Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ¡Ñ‚Ğ¸Ğ»ÑŒ:**
- Ğ¤Ğ¾Ğ½: `bg-purple-600/20` (Ğ¿Ğ¾Ğ»ÑƒĞ¿Ñ€Ğ¾Ğ·Ñ€Ğ°Ñ‡Ğ½Ñ‹Ğ¹ Ñ„Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ñ‹Ğ¹)
- Ğ¢ĞµĞºÑÑ‚: `text-purple-400` (ÑÑ€ĞºĞ¸Ğ¹ Ñ„Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ñ‹Ğ¹)
- Ğ“Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°: `border-purple-500/50` (Ñ„Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ğ°Ñ)
- Ğ˜ĞºĞ¾Ğ½ĞºĞ°: ğŸ‘ï¸ Eye (Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğ¹ Ğ³Ğ»Ğ°Ğ·)

---

### ĞĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ° (Ğ›Ğ¸Ğ½Ğ¸Ñ ÑĞºÑ€Ñ‹Ñ‚Ğ°)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘ï¸off â”€â”€â”€ Ğ£Ğ¼Ğ½Ñ‹Ğµ Ğ´ĞµĞ½ÑŒĞ³Ğ¸  â”‚ â† Ğ¡ĞµÑ€Ñ‹Ğ¹ Ñ„Ğ¾Ğ½, Ñ‚ÑƒÑĞºĞ»Ğ°Ñ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ¡Ñ‚Ğ¸Ğ»ÑŒ:**
- Ğ¤Ğ¾Ğ½: `bg-zinc-900/50` (Ñ‚ĞµĞ¼Ğ½Ğ¾-ÑĞµÑ€Ñ‹Ğ¹)
- Ğ¢ĞµĞºÑÑ‚: `text-zinc-600` (ÑĞµÑ€Ñ‹Ğ¹ Ñ‚ÑƒÑĞºĞ»Ñ‹Ğ¹)
- Ğ“Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°: `border-zinc-800` (Ñ‚ĞµĞ¼Ğ½Ğ°Ñ)
- Ğ˜ĞºĞ¾Ğ½ĞºĞ°: ğŸ‘ï¸off EyeOff (Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ñ‹Ğ¹ Ğ³Ğ»Ğ°Ğ·)

---

## ğŸ” Ğ›Ğ¾Ğ³Ğ¸ Ğ² ĞºĞ¾Ğ½ÑĞ¾Ğ»Ğ¸

### ĞŸÑ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹

```
[useFutoiCandles] ğŸ” Fetching candles for Si
[useFutoiCandles] ğŸ“… Period: 1 days (2026-02-03 â†’ 2026-02-03)
[MOEX] ğŸ“Š Processing 120 FUTOI records into candles...
[MOEX] âœ… Processed into 60 FUTOI candles
[FuturesDashboard] ğŸ”„ Processing chart data...
[FuturesDashboard] ğŸ“Š Calculating dynamic Y-axis domain...
[FuturesDashboard] ğŸ‘ï¸ Visible lines: { showSmart: true, showRetail: false }
[FuturesDashboard] â• Added Smart Money values
[FuturesDashboard] ğŸ“ Domain: {
  min: 6800000,
  max: 7200000,
  padding: 20000,
  final: [6780000, 7220000]
}
[CorrelationChart] ğŸ¨ Rendering with domain: [6780000, 7220000]
```

---

### ĞŸÑ€Ğ¸ toggle Smart Money (ÑĞºÑ€Ñ‹Ñ‚ÑŒ)

```
[FuturesDashboard] ğŸ“Š Calculating dynamic Y-axis domain...
[FuturesDashboard] ğŸ‘ï¸ Visible lines: { showSmart: false, showRetail: false }
[FuturesDashboard] âš ï¸ No visible lines, using default domain
[CorrelationChart] ğŸ¨ Rendering with domain: [0, 100]
```

---

### ĞŸÑ€Ğ¸ toggle Retail (Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ)

```
[FuturesDashboard] ğŸ“Š Calculating dynamic Y-axis domain...
[FuturesDashboard] ğŸ‘ï¸ Visible lines: { showSmart: false, showRetail: true }
[FuturesDashboard] â• Added Retail values
[FuturesDashboard] ğŸ“ Domain: {
  min: 950000,
  max: 1050000,
  padding: 5000,
  final: [945000, 1055000]
}
[CorrelationChart] ğŸ¨ Rendering with domain: [945000, 1055000]
```

**ĞĞ±Ñ€Ğ°Ñ‚Ğ¸Ñ‚Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ:** Domain **Ñ€ĞµĞ·ĞºĞ¾ ÑÑƒĞ·Ğ¸Ğ»ÑÑ** (7.2M â†’ 1.05M) - Retail Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ·Ğ°Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ²ĞµÑÑŒ ÑĞºÑ€Ğ°Ğ½!

---

## ğŸ“ ĞšĞ¾Ğ´ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°

### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° FuturesDashboard.tsx

```
FuturesDashboard (Parent Component)
â”‚
â”œâ”€ State
â”‚  â”œâ”€ selectedTicker: string
â”‚  â”œâ”€ timeframe: 1 | 14
â”‚  â”œâ”€ searchQuery: string
â”‚  â”œâ”€ showSearch: boolean
â”‚  â”œâ”€ showPrice: boolean
â”‚  â”œâ”€ showSmart: boolean
â”‚  â””â”€ showRetail: boolean
â”‚
â”œâ”€ Data Fetching
â”‚  â”œâ”€ useActiveFutures() â†’ futuresData
â”‚  â””â”€ useFutoiCandles(ticker, timeframe) â†’ data
â”‚
â”œâ”€ Computed (useMemo)
â”‚  â”œâ”€ filteredFutures (Ğ´Ğ»Ñ Omni-Search)
â”‚  â”œâ”€ chartData (Ñ‚Ñ€Ğ°Ğ½ÑÑ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Recharts)
â”‚  â”œâ”€ rightAxisDomain (DYNAMIC SCALING)
â”‚  â””â”€ divergence (Ğ°Ğ²Ñ‚Ğ¾Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ)
â”‚
â”œâ”€ Callbacks (useCallback)
â”‚  â”œâ”€ togglePrice()
â”‚  â”œâ”€ toggleSmart()
â”‚  â””â”€ toggleRetail()
â”‚
â””â”€ Render
   â”œâ”€ Top Control Bar (Timeframe)
   â”œâ”€ Divergence Badges
   â”œâ”€ Omni-Search (Ñ dropdown)
   â”œâ”€ Toggle Controls (Chip buttons)
   â”œâ”€ CorrelationChart (memoized)
   â”œâ”€ Stats Grid (4 ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸)
   â””â”€ Info Panel (Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ)
```

---

## ğŸ¯ ĞšĞ»ÑÑ‡ĞµĞ²Ğ¾Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ²Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ

### rightAxisDomain - Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½

**Dependencies:** `[chartData, showSmart, showRetail]`

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°:**
1. Ğ•ÑĞ»Ğ¸ Ğ¾Ğ±Ğµ Ğ»Ğ¸Ğ½Ğ¸Ğ¸ Ğ²Ğ¸Ğ´Ğ½Ñ‹ â†’ domain = [min(Smart, Retail), max(Smart, Retail)]
2. Ğ•ÑĞ»Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Smart â†’ domain = [min(Smart), max(Smart)]
3. Ğ•ÑĞ»Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Retail â†’ domain = [min(Retail), max(Retail)]
4. Ğ•ÑĞ»Ğ¸ Ğ¾Ğ±Ğµ ÑĞºÑ€Ñ‹Ñ‚Ñ‹ â†’ domain = [0, 100]

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:** ĞšĞ°Ğ¶Ğ´Ğ°Ñ Ğ»Ğ¸Ğ½Ğ¸Ñ **Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ** Ğ´Ğ»Ñ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹.

---

## âœ… Ğ§ĞµĞºĞ»Ğ¸ÑÑ‚ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸

### ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
- [x] React.memo Ğ´Ğ»Ñ CorrelationChart
- [x] useMemo Ğ´Ğ»Ñ chartData
- [x] useMemo Ğ´Ğ»Ñ rightAxisDomain
- [x] useMemo Ğ´Ğ»Ñ filteredFutures
- [x] useMemo Ğ´Ğ»Ñ divergence
- [x] useCallback Ğ´Ğ»Ñ toggle handlers

### Dynamic Y-Axis Scaling
- [x] Ğ Ğ°ÑÑ‡ĞµÑ‚ domain Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ñ‹Ñ… Ğ»Ğ¸Ğ½Ğ¸Ğ¹
- [x] Padding 5% Ğ´Ğ»Ñ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿Ğ¾Ğ²
- [x] Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ°
- [x] Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒ
- [x] Debug info Ğ² UI

### Toggle Controls
- [x] Chip buttons Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ»Ğ¸Ğ½Ğ¸Ğ¸
- [x] Eye/EyeOff Ğ¸ĞºĞ¾Ğ½ĞºĞ¸
- [x] Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ğ¾Ğµ ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Ñ„Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ñ‹Ğ¹/Ğ·ĞµĞ»ĞµĞ½Ñ‹Ğ¹/ÑĞµÑ€Ñ‹Ğ¹)
- [x] Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ»Ğ¸Ğ½Ğ¸Ğ¹ (ÑĞ¿Ğ»Ğ¾ÑˆĞ½Ğ°Ñ/Ğ¿ÑƒĞ½ĞºÑ‚Ğ¸Ñ€)

### Features
- [x] Omni-Search Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹
- [x] ĞĞ²Ñ‚Ğ¾Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ¸Ğ²ĞµÑ€Ğ³ĞµĞ½Ñ†Ğ¸Ğ¹
- [x] Stats Grid (4 ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸)
- [x] Timeframe selector
- [x] Loading/Error states

---

## ğŸ‰ Ğ˜Ñ‚Ğ¾Ğ³

**ĞŸĞ ĞĞ‘Ğ›Ğ•ĞœĞ Ğ Ğ•Ğ¨Ğ•ĞĞ:**

1. âœ… **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±:** Smart Money Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ½Ğµ "Ñ€Ğ°ÑĞ¿Ğ»ÑÑ‰Ğ¸Ğ²Ğ°ĞµÑ‚" Retail
2. âœ… **ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:** Ğ›Ğ°Ğ³Ğ¸ ÑƒÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ñ‹ Ñ‡ĞµÑ€ĞµĞ· React.memo + useMemo
3. âœ… **UX:** Toggle controls Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ rescale
4. âœ… **ĞĞ½Ğ°Ğ»Ğ¸Ğ·:** ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ¸Ğ·ÑƒÑ‡Ğ°Ñ‚ÑŒ Smart Ğ¸ Retail Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾ Ğ¸Ğ»Ğ¸ Ğ²Ğ¼ĞµÑÑ‚Ğµ

**Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞœĞ•ĞĞ¢ Ğ“ĞĞ¢ĞĞ’ Ğš ĞŸĞ ĞĞ¤Ğ•Ğ¡Ğ¡Ğ˜ĞĞĞĞ›Ğ¬ĞĞĞœĞ£ Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞĞ˜Ğ®!** ğŸš€

---

**Ğ”Ğ°Ñ‚Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ:** 3 Ñ„ĞµĞ²Ñ€Ğ°Ğ»Ñ 2026
