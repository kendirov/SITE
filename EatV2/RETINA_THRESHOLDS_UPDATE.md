# üéØ RETINA THRESHOLDS UPDATE - Feb 3, 2026

## üìä –û–°–ù–û–í–ê–ù–û –ù–ê –†–ï–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–• –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `debug_vision.py` –Ω–∞ **MacBook Air (Retina Display)** –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–º, –∫–∞–∫–∏–µ confidence levels –¥–∞–µ—Ç multi-scale matching –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–∞—Ö 0.5x-0.6x.

---

## ‚öôÔ∏è –ß–¢–û –ò–ó–ú–ï–ù–ï–ù–û –í `config.py`:

### 1. **THRESHOLDS** - –û–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

#### ‚úÖ –ö–†–ò–¢–ò–ß–ù–´–ï –ö–ù–û–ü–ö–ò (Adjusted for Retina):

| Template | OLD Threshold | Debug Result | NEW Threshold | Reason |
|----------|---------------|--------------|---------------|---------|
| `btn_buy` | **0.85** | 0.63 @ 0.5x | **0.60** | üî¥ –ö–†–ò–¢–ò–ß–ù–û! –ë—ã–ª —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π, –±–æ—Ç –ø—Ä–æ–ø—É—Å–∫–∞–ª –ø–æ–∫—É–ø–∫–∏ |
| `blue_button` | 0.75 | 0.73 @ 0.5x | **0.68** | –ù–µ–±–æ–ª—å—à–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ |
| `btn_close_x` | 0.70 | 0.48 @ 0.5x | **0.45** | –ù–∏–∑–∫–∏–π –∏–∑-–∑–∞ —Ñ–æ–Ω–∞, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç |
| `box_floor` | 0.70 | N/A | **0.55** | Lowered –¥–ª—è varied backgrounds |

#### ‚úÖ UPGRADE –≠–õ–ï–ú–ï–ù–¢–´ (Perfect Detection!):

| Template | OLD Threshold | Debug Result | NEW Threshold | Status |
|----------|---------------|--------------|---------------|---------|
| `upgrade_arrow` | 0.72 | **0.95** @ 0.5x | **0.85** | ‚úÖ –û–¢–õ–ò–ß–ù–û! –î–µ—Ä–∂–∏–º –≤—ã—Å–æ–∫–æ |
| `icon_upgrades` | 0.75 | **0.98** @ 0.5x | **0.90** | ‚úÖ –ò–î–ï–ê–õ–¨–ù–û! –î–µ—Ä–∂–∏–º –≤—ã—Å–æ–∫–æ |
| `tip_coin` | 0.70 | **0.90** @ 0.5x | **0.80** | ‚úÖ –û–¢–õ–ò–ß–ù–û! –î–µ—Ä–∂–∏–º –≤—ã—Å–æ–∫–æ |

#### ‚öôÔ∏è UI BUTTONS (Adjusted):

| Template | OLD ‚Üí NEW | Reason |
|----------|-----------|---------|
| `btn_okay` | 0.75 ‚Üí **0.70** | Retina compatibility |
| `btn_open_level` | 0.75 ‚Üí **0.70** | Retina compatibility |
| `btn_renovate` | 0.75 ‚Üí **0.70** | Retina compatibility |
| `btn_fly` | 0.75 ‚Üí **0.70** | Retina compatibility |
| `btn_confirm_renovate` | 0.80 ‚Üí **0.75** | Safety, but adjusted |
| `btn_fly_confirm` | 0.80 ‚Üí **0.75** | Safety, but adjusted |

---

### 2. **RETINA_SCALE_RANGE** - –ù–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (Prioritization)

```python
RETINA_SCALE_RANGE: Tuple[float, ...] = (0.5, 0.6, 0.75, 1.0)
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –£–∫–∞–∑—ã–≤–∞–µ—Ç priority scales –¥–ª—è Retina –¥–∏—Å–ø–ª–µ–µ–≤
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞: **–ª—É—á—à–∏–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–∞ 0.5x-0.6x**
- –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ `vision.py` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ç–∏ scales –ø–µ—Ä–≤—ã–º–∏)

**Fallback:**
- –ï—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –≤ `RETINA_SCALE_RANGE`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π `VISION_SCALES` (0.5 - 2.0)

---

## üìä –ê–ù–ê–õ–ò–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô:

### üî¥ –ö–†–ò–¢–ò–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: `btn_buy`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
OLD: "btn_buy": 0.85  # –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ!
Debug result: 0.63 @ scale 0.5x
‚Üí –ë–æ—Ç –ù–ï –ü–û–ö–£–ü–ê–õ –∞–ø–≥—Ä–µ–π–¥—ã! (0.63 < 0.85)
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
NEW: "btn_buy": 0.60  # –¢–µ–ø–µ—Ä—å 0.63 > 0.60 ‚úÖ
‚Üí –ë–æ—Ç –±—É–¥–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å –∞–ø–≥—Ä–µ–π–¥—ã!
```

**–ü–æ—á–µ–º—É –Ω–µ –Ω–∏–∂–µ?**
- 0.60 - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –±–∞–ª–∞–Ω—Å
- –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (ad buttons, investor buttons)
- Multi-scale —É–∂–µ –¥–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å, –Ω–µ –Ω—É–∂–Ω–æ –æ–ø—É—Å–∫–∞—Ç—å –Ω–∏–∂–µ

---

### ‚úÖ –û–¢–õ–ò–ß–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´: Upgrade Elements

**–î–∞–Ω–Ω—ã–µ:**
```
upgrade_arrow: 0.95 @ 0.5x (–ø–æ—Ä–æ–≥ 0.72) ‚Üí –ù–∞—à–ª–æ —Å –æ–≥—Ä–æ–º–Ω—ã–º –∑–∞–ø–∞—Å–æ–º!
icon_upgrades: 0.98 @ 0.5x (–ø–æ—Ä–æ–≥ 0.75) ‚Üí –ò–î–ï–ê–õ–¨–ù–û!
tip_coin:      0.90 @ 0.5x (–ø–æ—Ä–æ–≥ 0.70) ‚Üí –û–¢–õ–ò–ß–ù–û!
```

**–†–µ—à–µ–Ω–∏–µ:**
- –≠—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ò–î–ï–ê–õ–¨–ù–û –Ω–∞ Retina
- **–£–í–ï–õ–ò–ß–ò–õ–ò** –ø–æ—Ä–æ–≥–∏ –¥–æ 0.80-0.90 –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –Ω–∞ –ø–æ—Ö–æ–∂–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ù–´–ô –≠–õ–ï–ú–ï–ù–¢: `btn_close_x`

**–î–∞–Ω–Ω—ã–µ:**
```
btn_close_x: 0.48 @ 0.5x (–ø–æ—Ä–æ–≥ 0.70)
‚Üí –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π confidence (background issue)
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
"btn_close_x": 0.45  # Lowered to 0.45
```

**–ü–æ—á–µ–º—É —Ç–∞–∫ –Ω–∏–∑–∫–æ?**
- –ö—Ä–µ—Å—Ç–∏–∫ –º–∞–ª–µ–Ω—å–∫–∏–π –∏ –ø—Ä–æ—Å—Ç–æ–π (X)
- –§–æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º
- 0.45 - –º–∏–Ω–∏–º—É–º –¥–ª—è —Ä–∞–±–æ—Ç—ã
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∫–ª–∏–∫ –≤ "safe spot" (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–µ)

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ù–û–í–´–ô —à–∞–±–ª–æ–Ω `btn_close_x.png` —Å –±–æ–ª—å—à–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- –ò–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä —à–∞–±–ª–æ–Ω–∞ (–±–æ–ª—å—à–µ pixels –≤–æ–∫—Ä—É–≥ X)

---

## üéØ –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:

### –ü–æ—Ä–æ–≥–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

**–û—á–µ–Ω—å –Ω–∞–¥–µ–∂–Ω—ã–µ (0.80-0.90):**
- ‚úÖ `icon_upgrades`: 0.90
- ‚úÖ `upgrade_arrow`: 0.85
- ‚úÖ `tip_coin`: 0.80

**–°—Ä–µ–¥–Ω—è—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å (0.60-0.75):**
- ‚öôÔ∏è `btn_buy`: 0.60 (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
- ‚öôÔ∏è `blue_button`: 0.68
- ‚öôÔ∏è UI buttons: 0.70
- ‚öôÔ∏è Confirm buttons: 0.75

**–ù–∏–∑–∫–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å (0.45-0.55):**
- ‚ö†Ô∏è `btn_close_x`: 0.45 (fallback to safe spot)
- ‚ö†Ô∏è `box_floor`: 0.55 (varied backgrounds)

---

## üöÄ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:

### –î–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```
üîç StationUpgrader: –ò—â—É upgrade_arrow...
üéØ –ù–∞–π–¥–µ–Ω–æ 3 —Å—Ç—Ä–µ–ª–æ–∫
üè™ –ê–ø–≥—Ä–µ–π–∂—É —Å—Ç–∞–Ω—Ü–∏—é...
  2Ô∏è‚É£  –ò—â—É –∫–Ω–æ–ø–∫—É BUY (–ø–æ—Ä–æ–≥ 0.85)...
  ‚ùå –ö–Ω–æ–ø–∫–∞ BUY –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ (confidence 0.63 < 0.85)
  ‚ö†Ô∏è  –ó–∞–∫—Ä—ã–≤–∞—é –º–µ–Ω—é –±–µ–∑ –ø–æ–∫—É–ø–∫–∏
```

### –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
```
üîç StationUpgrader: –ò—â—É upgrade_arrow...
DEBUG| Vision: Best match: scale=0.50, confidence=0.95
üéØ –ù–∞–π–¥–µ–Ω–æ 3 —Å—Ç—Ä–µ–ª–æ–∫
üè™ –ê–ø–≥—Ä–µ–π–∂—É —Å—Ç–∞–Ω—Ü–∏—é...
  2Ô∏è‚É£  –ò—â—É –∫–Ω–æ–ø–∫—É BUY (–ø–æ—Ä–æ–≥ 0.60)...
DEBUG| Vision: Best match: scale=0.50, confidence=0.63
  3Ô∏è‚É£  üí∞ –ö–Ω–æ–ø–∫–∞ BUY –Ω–∞–π–¥–µ–Ω–∞ - –∑–∞–∂–∏–º–∞—é 3 —Å–µ–∫—É–Ω–¥—ã...
‚úÖ –ê–ø–≥—Ä–µ–π–¥ –∑–∞–≤–µ—Ä—à–µ–Ω!
```

---

## üîß –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò:

### –ï—Å–ª–∏ –±–æ—Ç —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –æ—à–∏–±–∞–µ—Ç—Å—è:

**–£–≤–µ–ª–∏—á—å –ø–æ—Ä–æ–≥–∏:**
```python
"btn_buy": 0.65,        # –í–º–µ—Å—Ç–æ 0.60
"blue_button": 0.70,    # –í–º–µ—Å—Ç–æ 0.68
```

### –ï—Å–ª–∏ –±–æ—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã:

**–£–º–µ–Ω—å—à–∏ –ø–æ—Ä–æ–≥–∏:**
```python
"btn_buy": 0.55,        # –í–º–µ—Å—Ç–æ 0.60
"blue_button": 0.65,    # –í–º–µ—Å—Ç–æ 0.68
```

### –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –µ—â–µ –±–æ–ª—å—à–µ —É—Å–∫–æ—Ä–∏—Ç—å (advanced):

**–í `core/vision.py` –∏—Å–ø–æ–ª—å–∑—É–π priority scales:**
```python
# Try Retina scales first (faster)
for scale in config.RETINA_SCALE_RANGE:
    # ... matching logic ...
    if found:
        return result

# Fallback to full range if not found
for scale in config.VISION_SCALES:
    # ... matching logic ...
```

---

## üìù CHANGELOG:

### Feb 3, 2026 - Retina Thresholds Update

**Changed:**
- `btn_buy`: 0.85 ‚Üí **0.60** (CRITICAL FIX)
- `blue_button`: 0.75 ‚Üí **0.68**
- `btn_close_x`: 0.70 ‚Üí **0.45**
- `box_floor`: 0.70 ‚Üí **0.55**
- `upgrade_arrow`: 0.72 ‚Üí **0.85** (increased!)
- `icon_upgrades`: 0.75 ‚Üí **0.90** (increased!)
- `tip_coin`: 0.70 ‚Üí **0.80** (increased!)
- UI buttons: 0.75 ‚Üí **0.70** (all)
- Confirm buttons: 0.80 ‚Üí **0.75** (both)

**Added:**
- `RETINA_SCALE_RANGE = (0.5, 0.6, 0.75, 1.0)`
- Comments explaining each threshold adjustment
- Debug results documentation

**Reason:**
- Based on real debug data from MacBook Air Retina
- Multi-scale matching confirmed at 0.5x-0.6x scale
- Old thresholds were calibrated for 1.0x scale, too high for Retina

---

## ‚úÖ –¢–ï–°–¢-–ü–õ–ê–ù:

### 1. –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç (5 –º–∏–Ω—É—Ç):
```bash
python3 run.py
```

–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –±–æ—Ç:
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç `upgrade_arrow`
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é —Å—Ç–∞–Ω—Ü–∏–∏
- ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç `btn_buy` (–ö–†–ò–¢–ò–ß–ù–û!)
- ‚úÖ –ü–æ–∫—É–ø–∞–µ—Ç –∞–ø–≥—Ä–µ–π–¥ (long press)
- ‚úÖ –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –º–µ–Ω—é

### 2. –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç (15 –º–∏–Ω—É—Ç):

–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –±–æ—Ç:
- ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç `tip_coin`
- ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç `box_floor`
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç `icon_upgrades`
- ‚úÖ –ö–ª–∏–∫–∞–µ—Ç `blue_button`
- ‚úÖ –°–∫—Ä–æ–ª–ª–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (Navigator)
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç renovate/fly

### 3. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ:
```bash
python3 debug_vision.py
```

–£–±–µ–¥–∏—Å—å —á—Ç–æ:
- ‚úÖ –í—Å–µ –ø–æ—Ä–æ–≥–∏ —Ç–µ–ø–µ—Ä—å **–Ω–∏–∂–µ** confidence values
- ‚úÖ –ù–µ—Ç –∂–µ–ª—Ç—ã—Ö –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ (low confidence)
- ‚úÖ –í—Å–µ –∑–µ–ª–µ–Ω—ã–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏ (found!)

---

## üéâ –§–ò–ù–ê–õ–¨–ù–´–ô –°–¢–ê–¢–£–°:

```
‚úÖ Thresholds –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚úÖ RETINA_SCALE_RANGE –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–π –±–∞–≥ btn_buy –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
```

**–ó–ê–ü–£–°–ö–ê–ô –ë–û–¢–ê –ò –¢–ï–°–¢–ò–†–£–ô! üöÄ**

---

## üìö –°–í–Ø–ó–ê–ù–ù–´–ï –î–û–ö–£–ú–ï–ù–¢–´:

- `RETINA_FIX.md` - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ multi-scale fix
- `debug_vision.py` - –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
- `config.py` - –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `core/vision.py` - Multi-scale matching logic

**–í–°–Å –ì–û–¢–û–í–û –ö –†–ê–ë–û–¢–ï –ù–ê RETINA –î–ò–°–ü–õ–ï–ï! ‚ú®**
